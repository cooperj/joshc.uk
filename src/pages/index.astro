---
import { getCollection } from "astro:content";
import { SITE_DESCRIPTION, SITE_TITLE } from "@/consts";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { TopGithubRepos } from "@/components/TopGithubRepos";
import { Icon } from "astro-icon/components";

// Generic Item Type
type ContentItem = {
  slug: string;
  collection: string;
  data: {
    description: string;
    pubDate: Date;
    title: string;
  };
};

// Get Posts and projects
const posts = (await getCollection("blog", ({ data }) => {
  return data.draft !== true;
})) as ContentItem[];

const projects = (await getCollection("portfolio", ({ data }) => {
  return data.draft !== true;
})) as ContentItem[];

// Mix the contents and sort by newest first
const content: ContentItem[] = posts
  .concat(projects)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

// Get the last 5 contents
const latestContent = content.slice(0, 6);
---

<BaseLayout pageTitle={SITE_TITLE} pageDescription={SITE_DESCRIPTION}>
  <div class="flex items-center mx-5 mb-5 tablet:mb-20">
    <div
      class="flex-1 flex text-6xl font-serif items-center text-orange-600 dark:text-orange-500 mb-5 mr-2"
    >
      <p>Hey, I'm Josh!</p>
      <p class="ml-3 motion-safe:animate-wave">ðŸ‘‹</p>
    </div>
    <div>
      <picture>
        <source srcset="/images/joshua.webp" type="image/webp" />
        <source srcset="/images/joshua.jpg" type="image/jpeg" />
        <img
          aria-hidden="true"
          class="profile-mask w-56 hover:animate-wiggle"
          src="/images/joshua.jpg"
          alt="Profile Picture of Josh"
        />
      </picture>
    </div>
  </div>

  <article id="content" class="tablet:m-5">
    <div>
      <p>
        I am currently a technician at the
        <a href="https://www.lincoln.ac.uk/" target="_blank"
          >University of Lincoln</a
        >
        where I look after things such as our robots, computers, and software systems
        which we use for both teaching and research. Surrounding subject areas such
        as Computer Science and Engineering. These systems have been developed to
        help our students navigate around our department in the form of our signage
        or have a simple and intuitive experience to using our resources.
      </p>
      <p>
        I am interested in a range of activites, such as: software and
        application development, robotics, automation, networking, cloud,
        homelab and games.
      </p>
    </div>

    <div>
      <p>@Past Work Experience@</p>
    </div>

    <div>
      <p>@Education@</p>
    </div>

    <div>
      <h3>@@ Portfolio/Blog, need better name@@ What have I been up to?</h3>
      <p>I have been up to a collection of things such as:</p>
    </div>

    <div class="flex justify-center flex-wrap w-full tablet:-mx-4 my-10">
      {
        latestContent.map((item) => (
          <div class="bg-orange-100 dark:bg-orange-700 odd:bg-green-100 dark:odd:bg-green-700 px-4 py-4 m-2 rounded-xl flex flex-col w-full tablet:w-[calc(50%-2rem)] laptop:w-[calc(33.33%-2rem)] justify-start text-black-500 dark:text-white-500">
            <a
              href={`${item.collection}/${item.slug}`}
              class="text-black-500 dark:text-white-500 no-underline hover:text-black-600 dark:hover:text-white-600"
            >
              <h4>{item.data.title}</h4>
            </a>

            <span class="flex-1 no-underline">{item.data.description}</span>

            <a
              href={`${item.collection}/${item.slug}`}
              class="self-end justify-self-end	 mt-2 text-black-500 dark:text-white-500 no-underline hover:text-black-600 dark:hover:text-white-600 flex items-center"
            >
              Read More
              <Icon name="lucide:chevron-right" class="ml-2" />
            </a>
          </div>
        ))
      }
    </div>

    <p>
      If you would like to know more, you should check out my <a
        href="/portfolio">portfolio</a
      > and <a href="/blog">blog</a>.
    </p>

    <div class="flex justify-center flex-wrap w-full tablet:-mx-4 my-10">
      <TopGithubRepos username="cooperj" client:only="react" />
    </div>

    <div>
      <p>@CTA to contact page@</p>
    </div>
  </article>
</BaseLayout>
